<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />
  <title>KI-Sprachassistent</title>
  
  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: https: 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:; connect-src 'self' ws: wss: http: https:;" />
  
  <!-- Status Bar Style -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0f0f23" />

  <style>
    :root {
      --primary-color: #6366f1;
      --primary-hover: #5855eb;
      --secondary-color: #10b981;
      --danger-color: #ef4444;
      --warning-color: #f59e0b;
      --bg-primary: #0f0f23;
      --bg-secondary: #1a1a2e;
      --bg-tertiary: #16213e;
      --text-primary: #ffffff;
      --text-secondary: #a1a1aa;
      --glass-bg: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);
      --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.3);
      
      /* Dynamic Settings */
      --nebel-primary: #6366f1;
      --nebel-secondary: #10b981;
      --nebel-accent: #f59e0b;
      --animation-speed: 4s;
      --avatar-speed: 4s;
      --nebel-speed: 3s;
    }

    .reduced-motion * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-tertiary) 100%);
      min-height: 100vh;
      min-height: -webkit-fill-available;
      color: var(--text-primary);
      overflow-x: hidden;
      -webkit-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
    }

    /* Mobile-specific styles */
    .mobile-device {
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }

    .mobile-device .container {
      padding: 1rem;
      min-height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
    }

    .mobile-device .settings-header {
      padding-top: calc(env(safe-area-inset-top) + 1rem);
      padding-left: calc(env(safe-area-inset-left) + 1rem);
      padding-right: calc(env(safe-area-inset-right) + 1rem);
    }

    .mobile-device .touch-active {
      transform: scale(0.95);
      transition: transform 0.1s ease;
    }

    .mobile-device .avatar {
      width: 80px !important;
      height: 80px !important;
    }

    .mobile-device .main-card {
      margin: 0.5rem;
      padding: 1.5rem;
    }

    .mobile-device .settings-modal .settings-content {
      width: 95%;
      max-height: 90vh;
      margin: 5vh auto;
    }

    .mobile-device .notification-container {
      top: calc(env(safe-area-inset-top) + 80px);
      right: calc(env(safe-area-inset-right) + 10px);
      left: calc(env(safe-area-inset-left) + 10px);
      max-width: none;
    }

    /* Network status indicator */
    .offline::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: #ef4444;
      z-index: 9999;
      animation: pulse 2s infinite;
    }

    /* Touch feedback */
    .mobile-button {
      position: relative;
      overflow: hidden;
    }

    .mobile-button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
      pointer-events: none;
    }

    .mobile-button.touch-ripple::after {
      width: 300px;
      height: 300px;
    }

    /* Recording indicator for mobile */
    .mobile-recording-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(239, 68, 68, 0.1);
      backdrop-filter: blur(2px);
      z-index: 5000;
      display: none;
      align-items: center;
      justify-content: center;
    }

    .mobile-recording-overlay.active {
      display: flex;
    }

    .mobile-recording-content {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: 2rem;
      text-align: center;
      max-width: 300px;
    }

    .mobile-recording-pulse {
      width: 60px;
      height: 60px;
      background: var(--danger-color);
      border-radius: 50%;
      margin: 0 auto 1rem;
      animation: mobilePulse 1.5s infinite;
    }

    @keyframes mobilePulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
    }

    /* Copy all other styles from the original GUI here */
    /* This is a condensed version - in practice, copy all CSS from the original */

    /* Animated background elements */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
      animation: backgroundShift 15s ease-in-out infinite;
      z-index: -1;
    }

    @keyframes backgroundShift {
      0%, 100% { transform: translate(0, 0); }
      33% { transform: translate(-10px, -10px); }
      66% { transform: translate(10px, -5px); }
    }

    /* Mobile responsive adjustments */
    @media (max-width: 480px) {
      .mobile-device .settings-tabs {
        flex-wrap: wrap;
        gap: 0.25rem;
      }
      
      .mobile-device .settings-tab {
        font-size: 0.8rem;
        padding: 0.5rem 0.75rem;
      }
      
      .mobile-device .input-section {
        flex-direction: column;
        gap: 0.75rem;
      }
      
      .mobile-device .header h1 {
        font-size: 1.8rem;
      }
      
      .mobile-device .voice-button {
        font-size: 1rem;
        padding: 1.25rem;
      }
    }

    @media (max-height: 600px) {
      .mobile-device .avatar {
        width: 60px !important;
        height: 60px !important;
      }
      
      .mobile-device .header {
        margin-bottom: 0.5rem;
      }
      
      .mobile-device .main-card {
        gap: 1rem;
      }
    }
  </style>
</head>
<body class="mobile-device">
  <!-- Mobile Recording Overlay -->
  <div class="mobile-recording-overlay" id="mobileRecordingOverlay">
    <div class="mobile-recording-content">
      <div class="mobile-recording-pulse"></div>
      <h3>üé§ Sprechen Sie jetzt</h3>
      <p>Tippen Sie zum Stoppen</p>
      <div id="mobileRecordingTime" style="margin-top: 1rem; font-size: 1.2rem; font-weight: bold;">0s</div>
    </div>
  </div>

  <!-- Settings Header -->
  <div class="settings-header">
    <div class="logo">ü§ñ KI-Assistent</div>
    <div class="settings-btn" onclick="toggleSettingsMenu()" id="settingsBtn">
      <span class="settings-icon">‚öôÔ∏è</span>
      <div class="settings-menu" id="settingsMenu">
        <div class="settings-menu-item" onclick="openSettingsTab('audio')">
          <span class="icon">üé§</span>
          <span class="label">Audio-Einstellungen</span>
        </div>
        <div class="settings-menu-item" onclick="openSettingsTab('connection')">
          <span class="icon">üåê</span>
          <span class="label">Verbindung</span>
        </div>
        <div class="settings-menu-item" onclick="openLanguageSettings()">
          <span class="icon">üåç</span>  
          <span class="label">Sprache</span>
        </div>
        <div class="settings-menu-item divider" onclick="openSettingsTab('animations')">
          <span class="icon">üåä</span>
          <span class="label">Animationen</span>
        </div>
        <div class="settings-menu-item" onclick="openSettingsTab('appearance')">
          <span class="icon">üé®</span>
          <span class="label">Erscheinungsbild</span>
        </div>
        <div class="settings-menu-item" onclick="openSettingsModal()">
          <span class="icon">‚öôÔ∏è</span>
          <span class="label">Alle Einstellungen</span>
        </div>
        <div class="settings-menu-item divider" onclick="showSystemInfo()">
          <span class="icon">üìä</span>
          <span class="label">System-Info</span>
        </div>
        <div class="settings-menu-item" onclick="showAbout()">
          <span class="icon">‚ÑπÔ∏è</span>
          <span class="label">√úber</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Container -->
  <div class="notification-container" id="notificationContainer"></div>

  <!-- Settings Modal -->
  <div class="settings-modal" id="settingsModal">
    <div class="settings-content">
      <div class="settings-header">
        <div class="settings-title">‚öôÔ∏è Einstellungen</div>
        <button class="settings-close" onclick="closeSettingsModal()">√ó</button>
      </div>
      <div class="settings-body">
        <!-- Copy all settings panels from original GUI -->
        <!-- This includes all tabs: animations, audio, appearance, connection, advanced -->
      </div>
    </div>
  </div>

  <!-- Main App Content -->
  <div class="container">
    <div class="header">
      <h1>ü§ñ KI-Sprachassistent</h1>
      <p>Sprechen Sie mit Ihrem intelligenten Assistenten</p>
    </div>

    <div class="main-card">
      <!-- Status Bar (Order 1) -->
      <div class="status-bar">
        <div class="status-indicator">
          <div class="status-dot" id="statusDot"></div>
          <span id="statusText">Verbindung wird hergestellt...</span>
        </div>
        <div class="controls-grid">
          <button class="control-btn" onclick="clearResponse()">üóëÔ∏è L√∂schen</button>
        </div>
      </div>

      <!-- Text Input Section (Order 2) -->
      <div class="input-section">
        <input 
          type="text" 
          id="textInput" 
          class="text-input" 
          placeholder="Fragen Sie mich etwas..."
          onkeypress="handleKeyPress(event)"
        />
        <button onclick="sendText()" class="btn mobile-button" id="sendBtn">
          <span>üì§</span> Senden
        </button>
      </div>

      <!-- Avatar Section (Order 3) -->
      <div class="avatar-container">
        <div class="avatar" id="avatar">
          <div class="avatar-nebel">
            <div class="avatar-nebel-layer"></div>
            <div class="avatar-nebel-layer"></div>
            <div class="avatar-nebel-layer"></div>
          </div>
          <div class="avatar-core"></div>
        </div>
      </div>

      <!-- Response Section (Order 4) -->
      <div class="response-section">
        <div class="response-content" id="response">
          <div class="response-empty">Ihre Antwort erscheint hier...</div>
        </div>
        
        <!-- Waberner Nebel Animation -->
        <div class="nebel-animation" id="nebelAnimation">
          <div class="nebel-circle" style="--scale: 1"></div>
          <div class="nebel-circle" style="--scale: 0.8"></div>
          <div class="nebel-circle" style="--scale: 0.6"></div>
        </div>
      </div>

      <!-- Voice Controls (Order 5) -->
      <div class="voice-controls">
        <button onclick="toggleRecording()" class="btn voice-button mobile-button" id="voiceBtn">
          <span id="voiceIcon">üé§</span>
          <span id="voiceText">Spracheingabe starten</span>
        </button>
        
        <div class="recording-indicator" id="recordingIndicator">
          <div class="recording-dot"></div>
          <span>Aufnahme l√§uft... <span id="recordingTime">0s</span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Cordova/PhoneGap -->
  <script type="text/javascript" src="cordova.js"></script>
  
  <!-- Mobile-specific JavaScript -->
  <script type="text/javascript" src="js/mobile-app.js"></script>
  
  <!-- Main App JavaScript -->
  <script type="text/javascript" src="js/app.js"></script>
</body>
</html>
